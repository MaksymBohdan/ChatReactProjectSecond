1
00:00:00,780 --> 00:00:09,350
Now we want to set up an on click handler to the star icon within our messages Hetter we'll head to

2
00:00:09,860 --> 00:00:17,880
the messages had her component button on clicked the icon will set it equal to handle star which will

3
00:00:17,880 --> 00:00:23,550
handle starring a given channel and will create the function for this within in our messages component.

4
00:00:23,610 --> 00:00:31,030
First to add a property to a state called Channel Sard said initially the false so this will keep track

5
00:00:31,630 --> 00:00:34,900
as to whether a given channel has been started previously.

6
00:00:34,910 --> 00:00:38,710
So now create our Hindu star function when we call Hindol star.

7
00:00:38,710 --> 00:00:44,510
We want to change is channel started to its opposite value and will do so using an inline function of

8
00:00:44,510 --> 00:00:48,350
a concert stage or get access to the entire previous state.

9
00:00:48,410 --> 00:00:51,730
No update is channel started according to that.

10
00:00:51,810 --> 00:00:52,770
Who said it to not.

11
00:00:52,810 --> 00:00:59,850
Previous state DOT is channel starved though always give us the opposite value.

12
00:01:00,050 --> 00:01:04,760
And then within the callback to says state when is channel start is updated.

13
00:01:04,800 --> 00:01:08,130
Will execute a function called Star Channel.

14
00:01:08,130 --> 00:01:14,200
This will check to see first of all if is channel start is set to true.

15
00:01:15,060 --> 00:01:18,600
If so for now we'll just log the Texstar.

16
00:01:18,600 --> 00:01:24,180
Otherwise if it's at the Falls we'll log On-Star to add the functionality for storing and unstring a

17
00:01:24,180 --> 00:01:33,170
channel there in just a minute then down with a render function we want to do structure is channel start

18
00:01:33,170 --> 00:01:35,820
from state and to our messages.

19
00:01:36,050 --> 00:01:46,800
We want to pass handle star handle star function via props as well as is channel starved.

20
00:01:46,880 --> 00:01:57,090
So now we're making an All-Star available to the messages header for our icon.

21
00:01:57,290 --> 00:01:59,500
Now execute the handle star function

22
00:02:06,320 --> 00:02:12,000
and now on the icon we want to change the appearance of it.

23
00:02:14,760 --> 00:02:23,250
When a given channel has been started so based on whether its channel started to set to true either

24
00:02:23,250 --> 00:02:30,970
give the name of the icon star or star outline and asked for the color or set up a similar turn every

25
00:02:32,860 --> 00:02:39,080
where if a channel star who set the color to yellow or black.

26
00:02:39,100 --> 00:02:43,860
If not we'll save that now.

27
00:02:43,870 --> 00:02:45,270
Test this out within our.

28
00:02:46,670 --> 00:02:54,070
We'll try clicking on the icon for a given public channel and we should see that the icon turns yellow.

29
00:02:54,070 --> 00:03:00,370
We see the log of star if we click on it again we see On-Star and changes back to black and outlined

30
00:03:02,710 --> 00:03:07,590
and we can click on this as many times as we like and our is Channel star property is always updated

31
00:03:07,590 --> 00:03:11,140
correctly back within messages.

32
00:03:11,150 --> 00:03:17,120
Let's add the functionality within Star Channel to actually update the data within our database.

33
00:03:17,450 --> 00:03:25,790
And in particular we want to update the user object for a given user we want to add a stored property

34
00:03:25,910 --> 00:03:29,830
to the use of that stars the channel and the stored property start.

35
00:03:29,840 --> 00:03:37,250
Object will include an array of IDs for each channel start that ID will include information about that

36
00:03:37,250 --> 00:03:48,180
channel the name of the channel the details about it as well as who created the channel with a created

37
00:03:48,180 --> 00:03:50,960
by object.

38
00:03:51,350 --> 00:03:56,210
And that will include the name of the user as well as their avatar

39
00:04:03,940 --> 00:04:04,660
if we add this

40
00:04:07,650 --> 00:04:09,900
can see an example of what this will look like.

41
00:04:09,960 --> 00:04:15,210
This started property with an array of IDs for each channel that starred.

42
00:04:15,390 --> 00:04:24,660
So to implement this all out we had back to start channel and we want to grab the users raw since we're

43
00:04:25,050 --> 00:04:27,820
updating a given user and their data.

44
00:04:28,020 --> 00:04:37,120
So create users or property and state that to firebase that database start for the string of users

45
00:04:41,120 --> 00:04:46,710
and we want to select a given child of that ref based on the user's ID.

46
00:04:46,710 --> 00:04:56,570
So add some template literals one interpolate the user's ID from state and and slash start to add this

47
00:04:56,570 --> 00:04:58,390
new property.

48
00:04:58,580 --> 00:05:05,900
Then we want to use the update method where on the object want to dynamically change the idea of the

49
00:05:05,900 --> 00:05:11,030
channel and its related data.

50
00:05:11,030 --> 00:05:19,940
So the idea will be set to an object with a name property a details property set to the channel name

51
00:05:19,940 --> 00:05:24,830
and the channel details and state will have are created by object

52
00:05:27,750 --> 00:05:37,750
and we'll get that from the does data channel that created by that name and their avatar we just change

53
00:05:37,750 --> 00:05:39,060
the end of that path.

54
00:05:41,290 --> 00:05:47,490
We created by Avatar.

55
00:05:47,600 --> 00:05:55,380
So for every channel that we store we're adding a new channel ID with all the information about it.

56
00:05:55,570 --> 00:06:03,610
Then in the case we want to take the same child the same user id slash start

57
00:06:06,350 --> 00:06:15,200
and then the child of that would be the channel ID and use the Remove method or once again we can catch

58
00:06:15,200 --> 00:06:21,070
any errors by making sure the error is not equal to no.

59
00:06:22,230 --> 00:06:27,140
And if so we use a console error to display it in our console.

60
00:06:27,140 --> 00:06:31,180
So save that now to test this out.

61
00:06:31,180 --> 00:06:35,080
Let's star our first channel once we do that.

62
00:06:35,120 --> 00:06:41,060
You can see the new START property added to our current user which contains the channel ID of the channel

63
00:06:41,060 --> 00:06:48,290
we start as well as all of its related information within it we can add to the second channel star that

64
00:06:48,290 --> 00:06:49,260
as well.

65
00:06:49,940 --> 00:06:55,300
But when we flip back to the first channel we dont see the star as yellow anymore.

66
00:06:55,340 --> 00:07:01,060
Yet we still have all of the information for that channel within our starred property in the database.

67
00:07:02,000 --> 00:07:07,520
So are you I doesn't reflect what we have in our database and even if we refresh the star is still black

68
00:07:07,520 --> 00:07:09,150
and outlined.

69
00:07:10,000 --> 00:07:14,780
Do you get information about the channels that a given user has previously stored or create another

70
00:07:14,780 --> 00:07:18,420
listener which will execute within component amount.

71
00:07:18,470 --> 00:07:24,200
So when the component mounts we're going to call add user stars listner which will take the current

72
00:07:24,200 --> 00:07:27,370
channel ID as was the current user ID

73
00:07:30,940 --> 00:07:40,340
and the add user stars Lisner will take both of these values in order to get all of the channels and

74
00:07:40,340 --> 00:07:47,510
the related information about the channels that the user has stored will take the users or select a

75
00:07:47,510 --> 00:07:55,790
child based on the user id and a child start to get the entire Sard property want to use the once method

76
00:07:56,630 --> 00:07:58,080
to get its value.

77
00:07:58,940 --> 00:08:06,860
And then within the then statement we'll get the data and we'll make sure that data value is not equal

78
00:08:06,860 --> 00:08:07,600
to know.

79
00:08:07,880 --> 00:08:16,640
So we have a value for stored property and will create a variable called Channel IDS will get all the

80
00:08:16,700 --> 00:08:25,730
channel IDs that a given user has saved and get an array of them using object keys and will take this

81
00:08:26,360 --> 00:08:33,290
array of IDs and use the includes method and check to see if our given channel ID is present within

82
00:08:33,290 --> 00:08:36,070
it will set the return value to previously stored.

83
00:08:36,440 --> 00:08:41,060
And if it finds that within this array it includes finds it to return a value of true.

84
00:08:41,180 --> 00:08:48,340
And we want to update is channel start based on the previously stored variable but stored in that will

85
00:08:48,380 --> 00:08:56,390
save that back and we can see immediately that our star for our first channel is yellow reflecting what

86
00:08:56,390 --> 00:09:02,650
we have in our database and a star for our second channel is yellow as well so we can toggle that reverse

87
00:09:02,650 --> 00:09:04,090
of the page.

88
00:09:04,640 --> 00:09:08,860
You can see our first panel once again is stored in the second channel is not.

89
00:09:09,200 --> 00:09:11,630
Which lines up with our database for our given user.

