1
00:00:00,360 --> 00:00:05,730
One of the last steps that we need to take before deployment is that since we've set up a lot of listeners

2
00:00:05,730 --> 00:00:13,380
within our components we need to win our component announce remove those listeners to begin the color

3
00:00:13,380 --> 00:00:20,310
panel we'll set up a component will unmount lifecycle method and we'll call a function called remove

4
00:00:20,310 --> 00:00:24,560
listener or remove the one listener that we have set up.

5
00:00:29,420 --> 00:00:35,660
So reference users as well as the child that we're listening on of this starts data user ID and the

6
00:00:35,660 --> 00:00:36,840
colors property.

7
00:00:36,950 --> 00:00:42,950
And then finally call the off method in order to remove that listener that we set up with component

8
00:00:42,950 --> 00:00:46,930
and mount So moving onto our message form component.

9
00:00:46,930 --> 00:00:56,000
We have this upload task property and state which holds onto the currently uploading image.

10
00:00:56,720 --> 00:01:02,030
And if our component mounts we don't want to remove a listener but we do want to cancel any uploads

11
00:01:02,030 --> 00:01:03,590
that may be taking place.

12
00:01:03,590 --> 00:01:09,740
So if upload task is not equal to know within state we're going to use the cancel method on it to cancel

13
00:01:09,770 --> 00:01:17,660
uploading the file that might be within it and we'll set state to update the upload task properties

14
00:01:17,660 --> 00:01:27,020
to know then we'll move on to the messages component and removing the listeners here or or quite a bit

15
00:01:27,110 --> 00:01:30,510
more effort than the other components.

16
00:01:31,980 --> 00:01:37,650
Again all set up component will unmount will execute this remove listeners function which will take

17
00:01:37,660 --> 00:01:47,040
in a property from state of listeners set initially to an empty tray will collect the information about

18
00:01:47,040 --> 00:01:55,740
each of the listeners that we set up on component mount with the listeners array and we'll add a new

19
00:01:55,800 --> 00:02:02,620
element to the listeners are using this ad to listeners function that takes the id rather an event that

20
00:02:02,650 --> 00:02:08,650
a given listeners using and within the function will first iterate over the listeners or to check to

21
00:02:08,650 --> 00:02:14,980
see if we already have the data stored for a given listener by comparing the ID ref and event guys that

22
00:02:14,980 --> 00:02:17,820
are passed in with each of the elements.

23
00:02:18,100 --> 00:02:26,050
And if we can't find the index of an element with each of these values are going to add a new object

24
00:02:26,140 --> 00:02:35,290
onto the Wisner's array creating a new listener object with the property name and values of ID ref an

25
00:02:35,290 --> 00:02:41,140
event that are passed to it will set up a state where we'll update the listeners array by concatenating

26
00:02:41,140 --> 00:02:45,040
this new listener object onto the listeners array.

27
00:02:45,730 --> 00:02:53,970
Now go down to each listener and call add to listeners in order to collect the data for it to execute.

28
00:02:53,970 --> 00:02:59,380
Add to listeners underneath where we're listening for the child added event for our typing wrap.

29
00:02:59,830 --> 00:03:08,510
So passen to the function call Channel ID typing route and the channel additive and we can copy that

30
00:03:08,810 --> 00:03:15,470
and go underneath the child removed for our typing graph and just change the event argument to child

31
00:03:15,470 --> 00:03:17,240
or moved.

32
00:03:17,390 --> 00:03:26,500
We'll then go to add message listener will change the wrap argument to ref and it will also pass in

33
00:03:26,920 --> 00:03:33,490
the event of child added then create or remove listeners function which will do the work of removing

34
00:03:34,000 --> 00:03:42,580
every listener whose data we have stored in this listener's array remove listeners will take the listeners

35
00:03:42,580 --> 00:03:46,060
or they will use the for each method on it.

36
00:03:46,060 --> 00:03:49,990
The listener will take the raw property on it.

37
00:03:52,450 --> 00:04:02,630
Or put the listener ID value on as a child and then call off and pass listener event to the method.

38
00:04:04,810 --> 00:04:06,570
Then within component of Mt..

39
00:04:07,300 --> 00:04:13,620
If we have a channel and user we want to remove any listeners and we can structure the listeners array

40
00:04:14,520 --> 00:04:15,710
there to pass to it.

41
00:04:18,190 --> 00:04:24,430
And also within component will announce we want to grab the connected raw and call off on that as well.

42
00:04:27,620 --> 00:04:36,100
Then moving on to our channels component we within the remove listeners function that we set up our

43
00:04:37,060 --> 00:04:38,930
removing the channels ref listener.

44
00:04:39,370 --> 00:04:48,780
But now we need to iterate over the channels or a state using for each in order to for each of the children

45
00:04:48,780 --> 00:04:58,120
that we put on the messages or call off on them bypassing each channel ID as a child.

46
00:04:59,830 --> 00:05:01,420
Then within direct messages

47
00:05:04,160 --> 00:05:06,470
will set up component will on Mount

48
00:05:09,190 --> 00:05:11,140
will execute remove listeners

49
00:05:13,970 --> 00:05:17,810
and remove listeners would be rather simple in this case.

50
00:05:18,110 --> 00:05:20,270
Well describe the users or call off on that

51
00:05:24,400 --> 00:05:35,860
and grab the president's rah and call it as well as the connected ref will say that and close it.

52
00:05:35,870 --> 00:05:37,910
Move on to a start.

53
00:05:40,710 --> 00:05:42,400
Set up component will unmount their

54
00:05:45,910 --> 00:05:48,870
We'll call a function remove listener.

55
00:05:49,340 --> 00:05:57,610
Well we want to move one listener where we're listening on our users or off with the child

56
00:06:00,940 --> 00:06:08,690
where we will interpolate the user id slash start and then call off on that.

57
00:06:08,710 --> 00:06:14,920
And finally once we save all of our changes and removing all of our listeners

58
00:06:19,670 --> 00:06:23,320
will once again use my deployed app.

59
00:06:23,520 --> 00:06:30,390
Currently it looks like channels the start component as well as the color panel are being loaded successfully

60
00:06:30,450 --> 00:06:34,050
along with the messages another user can still type.

61
00:06:34,050 --> 00:06:39,100
We see that they're typing and when they add a new message we see it show up.

