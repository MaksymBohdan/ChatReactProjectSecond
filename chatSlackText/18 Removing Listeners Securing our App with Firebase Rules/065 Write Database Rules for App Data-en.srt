1
00:00:00,560 --> 00:00:05,940
This like we made our storage area more secure by setting the rules for what images could be added to

2
00:00:05,940 --> 00:00:12,570
certain paths we're now going to add rules to our database to determine what data can be read or written

3
00:00:12,570 --> 00:00:14,820
to for each of our collections.

4
00:00:15,060 --> 00:00:22,940
So create a new rules Jason object first for our Channel's collection are going to allow reads with

5
00:00:22,950 --> 00:00:29,970
this dot read Rule by making sure the user is authorized.

6
00:00:30,190 --> 00:00:35,900
So if auth is not equal to no rechannel we have this dynamic channel ID.

7
00:00:35,910 --> 00:00:41,620
Now you are going to allow rights we're going to allow users to create new channels and create this

8
00:00:41,620 --> 00:00:48,520
channel ID value if authors on equal to no and we're going to validate each new channel that's added

9
00:00:48,520 --> 00:00:55,480
with new data that has children we'll check to make sure each new channel added has the properties ID

10
00:00:55,600 --> 00:00:58,040
name created by in details.

11
00:01:00,070 --> 00:01:06,310
And we can additionally validate each of these properties within has children so validate the ID once

12
00:01:06,310 --> 00:01:08,120
again using the validate rule.

13
00:01:08,410 --> 00:01:17,560
We'll check to see if the value of this new data the value of the ID is equal to the channel ID will

14
00:01:17,570 --> 00:01:26,520
make sure that the name on the channel has a length that is greater than zero and will copy this and

15
00:01:26,520 --> 00:01:27,520
provide the same rule.

16
00:01:27,600 --> 00:01:37,550
But for our details so the user thats adding the name and details for our new channel has to provide

17
00:01:37,760 --> 00:01:41,450
some characters to them then for our messages collection.

18
00:01:41,480 --> 00:01:49,880
It has a dynamic channel ID value will allow that to be read if authors are equal to know

19
00:01:53,050 --> 00:01:54,870
will use validate again.

20
00:01:56,300 --> 00:02:01,730
Where we want to take the child of the route.

21
00:02:01,850 --> 00:02:11,570
In other words check to see if the channels collection plus this new channel ID exists within our database

22
00:02:11,570 --> 00:02:19,280
using the exists method on each channel ID will have a unique ID preach message gets added or allow

23
00:02:20,260 --> 00:02:25,400
a new message to be created and therefore write permission if authors non-equal to know.

24
00:02:25,400 --> 00:02:33,190
And so this is for public channels and will validate what's attached to this message ID.

25
00:02:33,200 --> 00:02:38,240
In other words all of the message information or any message that's added by checking to see if new

26
00:02:38,240 --> 00:02:44,290
data has the children content user and time stamp it has those properties and doesn't have the property

27
00:02:45,940 --> 00:02:46,910
image.

28
00:02:47,020 --> 00:02:53,170
So this would be for a text message but we also want to handle the case that our message has image data.

29
00:02:53,170 --> 00:03:04,670
So a copy of this conditional use and or operator and pasted in afterwards would replace the content

30
00:03:04,670 --> 00:03:09,030
property with image and image with content.

31
00:03:09,170 --> 00:03:15,890
So that would handle the case that we have an image message instead of a text message or validate the

32
00:03:15,950 --> 00:03:17,030
content property.

33
00:03:17,030 --> 00:03:18,920
If we have a text message

34
00:03:21,830 --> 00:03:28,720
by making sure that new data value has a length greater than zero will do the same for image that it

35
00:03:28,720 --> 00:03:32,230
has the length greater than zero and per user

36
00:03:34,910 --> 00:03:45,100
we can validate them by making sure that they have the children ID name in Avatar.

37
00:03:45,100 --> 00:03:47,840
So they at least have to have these three properties.

38
00:03:47,890 --> 00:03:51,270
They don't have to have the stored or color properties.

39
00:03:52,400 --> 00:04:02,330
Then we'll move on to our private messages collection where it will first have a unique ID that will

40
00:04:02,330 --> 00:04:12,320
call you I.D. one and another one within it of you on YouTube or both of the user IDs or read only if

41
00:04:12,580 --> 00:04:22,040
author is not equal to no and just like the role that we provided within our storage rules make sure

42
00:04:22,040 --> 00:04:28,910
that you the one variable is equal to or that your ID or your ID to is equal to or that you ID

43
00:04:31,760 --> 00:04:40,100
then that will contain a message ID reach message that's added to our private messages collection.

44
00:04:40,100 --> 00:04:46,090
And we can just copy and paste all of the relevant validation that we added previously for a message

45
00:04:46,090 --> 00:04:49,210
ID or messages collection.

46
00:04:54,250 --> 00:05:04,340
Then we move on to President and here will read all our reads give our users authenticated and rights

47
00:05:05,300 --> 00:05:10,060
if our users authenticated.

48
00:05:10,110 --> 00:05:15,660
Of course we're just updating whether they're present within the app or not whether they're online and

49
00:05:16,050 --> 00:05:17,830
will provide the same rules for typing.

50
00:05:17,970 --> 00:05:22,670
So every user will enable reads and writes

51
00:05:25,780 --> 00:05:34,990
and moving on to users will read if users authenticated

52
00:05:39,460 --> 00:05:46,910
and it will have a unique ID value all our rights.

53
00:05:47,210 --> 00:05:55,500
Auth is an equal to now and the art ID is equal to this new ID value thats being put on the users collection

54
00:05:58,580 --> 00:06:01,530
and will validate new data that has children.

55
00:06:01,700 --> 00:06:08,240
Make sure that each new user begins with the properties name and Avatar.

56
00:06:08,300 --> 00:06:18,160
And once again or validate these children for each user thats added We want to validate name so we can

57
00:06:18,160 --> 00:06:28,010
grab the name roll that we had above or the name we shall lets added and paste it down here within users

58
00:06:30,350 --> 00:06:35,090
and will provide the same role for Avatar.

59
00:06:35,170 --> 00:06:42,520
You could change the length to your own custom value say 5 or 6 if you'd like but for now just hit publish.

60
00:06:42,600 --> 00:06:46,060
Make sure we don't have any errors with any of our rules.

61
00:06:47,290 --> 00:06:49,780
And so now we've locked down our database.

