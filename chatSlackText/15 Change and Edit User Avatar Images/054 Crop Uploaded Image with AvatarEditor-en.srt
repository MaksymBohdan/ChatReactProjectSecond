1
00:00:00,720 --> 00:00:09,820
Next we want to be able to click on our change Avatar option choose a file and have a preview displayed

2
00:00:10,330 --> 00:00:18,510
underneath the file input in order for us to crop.

3
00:00:18,520 --> 00:00:19,660
So back in user panel

4
00:00:24,230 --> 00:00:33,330
on the input we'll add an onchange to put the file that we select within state reference a handle change

5
00:00:33,330 --> 00:00:33,800
function

6
00:00:38,400 --> 00:00:45,660
and handle change will take an event where once again we'll have a file variable that will reference

7
00:00:45,660 --> 00:00:47,710
the first file.

8
00:00:47,720 --> 00:00:50,920
The files are a from event target.

9
00:00:51,270 --> 00:00:57,700
And here we're going to use the file reader API in order to.

10
00:00:58,380 --> 00:01:03,720
Once we check to make sure that we have a file within our how variable we're going to use the reader

11
00:01:04,470 --> 00:01:15,030
and this read as a data you are all method to read the file or then our RIDO will listen for the Load

12
00:01:15,030 --> 00:01:24,660
event and then the callback that we're going to set the preview image property within state to reader

13
00:01:24,660 --> 00:01:25,620
dot result.

14
00:01:28,150 --> 00:01:38,270
So create a preview image add that to an empty string in St..

15
00:01:38,350 --> 00:01:44,060
And now we want to bring in a tool called Avatar editor from re-act Avatar editor

16
00:01:46,960 --> 00:01:49,890
and this is what you use to crop the image.

17
00:01:50,440 --> 00:01:53,370
The preview image that we now have access to.

18
00:01:53,380 --> 00:02:04,740
So all these structure preview image from state and then within the first grade column will take the

19
00:02:04,740 --> 00:02:05,510
preview image.

20
00:02:05,520 --> 00:02:13,200
And if we have a preview image we're going to show the Avatar editor component where it accepts an image

21
00:02:13,200 --> 00:02:16,670
Propp which will set equal to preview image.

22
00:02:16,740 --> 00:02:27,220
Give it a weight of 120 pixels and the height of the same and a border of 50 pixels and we can scale

23
00:02:28,180 --> 00:02:36,370
the image with the value of 1.2 to make it zoomed in a bit more.

24
00:02:36,380 --> 00:02:43,550
Now once we save that and we select Change Avatar we choose a file.

25
00:02:43,570 --> 00:02:47,730
Now we can see our avatar editor.

26
00:02:47,800 --> 00:02:55,870
So now what selected within this box is what we use to crop our image and then we'll click on the preview

27
00:02:55,870 --> 00:02:58,770
button in order to perform the cropping.

28
00:03:01,610 --> 00:03:08,170
So and in unclick to our preview button that they're equal to handle crop image

29
00:03:13,110 --> 00:03:14,690
so create this new function.

30
00:03:20,030 --> 00:03:28,280
To crop our preview image we need to add a ref to our avatar editor component.

31
00:03:28,280 --> 00:03:34,130
So had this ref Propp and on the ref we want to create an inline function.

32
00:03:34,270 --> 00:03:36,480
We passed this value of node and assign it to

33
00:03:39,620 --> 00:03:40,510
Avatar editor

34
00:03:44,040 --> 00:03:49,410
So Avatar editor is now in our class we can reference it with this avatar Ed. We'll first check to see

35
00:03:49,410 --> 00:03:56,820
that we have this reference then on this ref we can execute the method.

36
00:03:56,830 --> 00:03:59,540
Get image scaled to canvas.

37
00:03:59,620 --> 00:04:05,410
This will do the cropping or image and we want to convert this to an image blob so we use the method

38
00:04:05,410 --> 00:04:11,460
to blob within that callback we get access to the return blob.

39
00:04:11,470 --> 00:04:22,550
We want to create an image Israel by taking the create object your own method and passing in the BLOB.

40
00:04:22,630 --> 00:04:31,270
And we want to set state you want to put the image that we're creating on this cropped image property

41
00:04:31,270 --> 00:04:39,420
and pass the blob to its own property and state where the cropped image property will allow us to see

42
00:04:39,420 --> 00:04:46,270
another preview of the image that we've selected with the Avatar editor component and the blob will

43
00:04:46,270 --> 00:04:51,570
be necessary for sending the image file over to firebase storage.

44
00:04:51,570 --> 00:04:58,200
So the structure cropped image from state within render and then within our second grade column we're

45
00:04:58,200 --> 00:05:03,530
going to first check to see if we have a value for a cropped image in state.

46
00:05:03,670 --> 00:05:15,220
If so we're going to render an image component whose style property will be set to margin equal to point

47
00:05:15,230 --> 00:05:29,910
five AMS auto with 100 pixels a high of 100 pixels a source set to cropped image.

48
00:05:30,030 --> 00:05:35,190
Then we'll head down to our change Avatar button we'll set up a condition where we'll only show this

49
00:05:35,190 --> 00:05:36,690
one if we have a cropped image

50
00:05:43,490 --> 00:05:44,660
and once we save that file

51
00:05:47,430 --> 00:05:49,530
we can test this out.

52
00:05:49,730 --> 00:05:51,210
We're going to change avatar.

53
00:05:51,360 --> 00:05:52,200
We'll choose a file

54
00:05:55,850 --> 00:05:56,950
we'll see our preview

55
00:05:59,740 --> 00:06:04,990
and once we click on the preview button we can see the cropped image with the selection that we chose.

56
00:06:05,320 --> 00:06:11,070
We can change that selection and hit preview again if we like to get a different crop.

57
00:06:13,330 --> 00:06:18,400
And then in the next section we'll set up the functionality for our change Avatar button in order to

58
00:06:18,400 --> 00:06:21,210
persist the changes that we made with our image.

